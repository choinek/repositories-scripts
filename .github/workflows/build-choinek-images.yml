name: Build and Push Choinek Images

on:
   push:
      branches:
         - main

jobs:
   build-and-push:
      runs-on: ubuntu-latest

      permissions:
         contents: read
         packages: write

      steps:
         -  name: Checkout Code
            uses: actions/checkout@v4

         -  name: Login to GitHub Container Registry
            uses: docker/login-action@v3
            with:
               registry: ghcr.io
               username: ${{ github.actor }}
               password: ${{ secrets.GITHUB_TOKEN }}

         -  name: Build Docker Image
            run: | 
               docker build -f ci-images/php-scripts_8.4.Dockerfile -t ghcr.io/choinek/ci-images/php-scripts:8.4 .

         -  name: Push Docker Image
            run: |
               docker push ghcr.io/choinek/images/php-scripts:8.4
